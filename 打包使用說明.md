# 🎁 築未科技大腦 - 打包使用說明

## 🚨 剛才遇到的問題已解決！

您遇到的錯誤是因為 PyInstaller 沒有添加到系統 PATH。我已經創建了修復版本的腳本。

---

## 📦 打包方法（三選一）

### 方法 1: 使用簡化腳本（推薦）

```bash
build_simple.bat
```

**優點**：
- ✅ 自動處理 PATH 問題
- ✅ 直接使用 `python -m PyInstaller`
- ✅ 包含詳細進度提示
- ✅ 錯誤信息更清晰

---

### 方法 2: 使用更新後的完整腳本

```bash
build_installer.bat
```

**說明**：已修復為使用 `python -m PyInstaller`

---

### 方法 3: 手動打包（開發者）

```bash
# 步驟 1: 清理
rmdir /s /q build dist

# 步驟 2: 打包
python -m PyInstaller brain_server.spec

# 步驟 3: 複製文件
copy .env.example dist\ZheweiTechBrain\
copy README_軟件使用說明.md dist\ZheweiTechBrain\
```

---

## 🎯 推薦打包流程

### 第一次打包

1. **測試環境**（可選但推薦）：
   ```bash
   test_package.bat
   ```

2. **執行打包**：
   ```bash
   build_simple.bat
   ```

3. **測試運行**：
   ```bash
   cd dist\ZheweiTechBrain
   啟動大腦.bat
   ```

4. **壓縮分發**：
   使用 7-Zip 或 WinRAR 壓縮 `dist\ZheweiTechBrain` 資料夾

---

## 📂 打包後的文件結構

```
dist/ZheweiTechBrain/
├── ZheweiTechBrain.exe          # 主程序（約 15-30 MB）
├── 啟動大腦.bat                  # 啟動腳本
├── .env.example                 # 配置範例
├── README_軟件使用說明.md        # 使用手冊
├── brain_workspace/             # 靜態資源
│   └── static/
│       ├── index.html
│       ├── chat.html
│       └── ...
└── _internal/                   # PyInstaller 依賴（100-200 MB）
    ├── *.dll
    ├── *.pyd
    └── python314.dll
```

**總大小**：約 150-300 MB（取決於依賴）

---

## 🎨 客製化打包

### 添加應用程式圖標

1. 準備 `.ico` 文件（256x256 像素）
2. 修改打包命令：
   ```bash
   python -m PyInstaller --icon=logo.ico brain_server.py
   ```

### 單文件模式

```bash
python -m PyInstaller --onefile brain_server.py
```

⚠️ 注意：
- 啟動速度較慢（需解壓到臨時目錄）
- 靜態文件可能需要特殊處理
- 不推薦用於此項目

### 隱藏控制台

```bash
python -m PyInstaller --noconsole brain_server.py
```

⚠️ 建議保留控制台以便查看日誌

---

## 🔧 常見問題快速修復

### PyInstaller 未找到
```bash
python -m pip install pyinstaller --user
```

### 打包失敗 - 缺少模組
在命令中添加：
```bash
--hidden-import=模組名稱
```

### 靜態文件未包含
檢查路徑分隔符：
- Windows: `;`（分號）
- Linux/Mac: `:`（冒號）

---

## 📊 打包時間估計

| 配置 | 預估時間 |
|------|---------|
| 首次打包 | 3-5 分鐘 |
| 重新打包 | 2-3 分鐘 |
| 清理構建 | 1-2 分鐘 |

**系統要求**：
- CPU: 任意
- RAM: 至少 4GB 可用
- 磁碟: 至少 2GB 可用空間

---

## 🚀 分發準備

### 創建發布版本

```bash
# 1. 打包
build_simple.bat

# 2. 測試
cd dist\ZheweiTechBrain
啟動大腦.bat
# 確認能正常啟動並訪問 http://localhost:8002

# 3. 壓縮
cd ..
"C:\Program Files\7-Zip\7z.exe" a -tzip ZheweiTechBrain_v1.0.0_Windows.zip ZheweiTechBrain\

# 4. 驗證
# 在另一台電腦上解壓縮並測試
```

### 發布檢查清單

- [ ] 可執行文件運行正常
- [ ] 配置向導可用
- [ ] 靜態資源完整
- [ ] 使用說明文檔齊全
- [ ] 不包含敏感信息（API 金鑰等）
- [ ] 版本號正確
- [ ] 壓縮檔案大小合理（<300MB）

---

## 📚 相關文檔

- **完整使用說明**：`README_軟件使用說明.md`
- **打包開發指南**：`PACKAGING_GUIDE.md`
- **快速開始**：`QUICKSTART.md`
- **故障排除**：`TROUBLESHOOTING.md`

---

## 💡 專業建議

### 使用虛擬環境打包

可以減少打包大小：

```bash
# 創建虛擬環境
python -m venv venv

# 啟動虛擬環境
venv\Scripts\activate

# 安裝依賴
pip install -r requirements-brain.txt

# 打包
python -m PyInstaller brain_server.spec

# 完成後退出
deactivate
```

### 自動化打包（CI/CD）

創建 GitHub Actions workflow：
```yaml
name: Build Release

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-python@v2
      - run: pip install -r requirements-brain.txt
      - run: pip install pyinstaller
      - run: python -m PyInstaller brain_server.spec
      - uses: actions/upload-artifact@v2
        with:
          name: ZheweiTechBrain
          path: dist/ZheweiTechBrain
```

---

## 🎓 學習資源

- [PyInstaller 官方文檔](https://pyinstaller.org/en/stable/)
- [Python 打包最佳實踐](https://packaging.python.org/)
- [FastAPI 部署指南](https://fastapi.tiangolo.com/deployment/)

---

## ✅ 下一步

現在您可以：

1. ✨ 執行 `build_simple.bat` 開始打包
2. 📝 參考 `TROUBLESHOOTING.md` 解決問題
3. 🚀 使用 `setup_wizard.bat` 測試配置流程
4. 📦 壓縮並分發您的軟件

**祝打包順利！** 🎉

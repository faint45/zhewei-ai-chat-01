# 築未科技系統 - 網絡部署總結

## ✅ 系統狀態確認

**所有測試通過！** ✅

- ✅ 端口 8000（網站服務器）已啟動
- ✅ 端口 8005（遠程控制服務器）已啟動
- ✅ 所有 API 端點正常響應
- ✅ 所有系統文件完整
- ✅ 所有依賴套件已安裝

---

## 🌐 網絡部署方案

### 方案 1：Ngrok 內網穿透（最簡單）

**適用場景**：
- 個人使用、測試環境
- 臨時演示、快速驗證
- 無需固定域名

**使用方法**：
```batch
# 方式1：通過部署向導
快速部署向導.bat
# 選擇選項 1

# 方式2：直接運行
deploy_ngrok.bat
```

**訪問地址**：
- Ngrok 會提供一個臨時 URL（如：https://xxxx.ngrok-free.app）
- 每次啟動 Ngrok，URL 都會變化

**優點**：
- ⚡ 5 分鐘內完成
- 🔓 無需路由器配置
- 🌍 自動獲取 HTTPS

**缺點**：
- 🔄 URL 會變化
- 📊 免費版有連接限制
- 💾 需要保持 Ngrok 運行

---

### 方案 2：路由器端口轉發（推薦）

**適用場景**：
- 家庭網絡、固定寬帶
- 小團隊、長期使用
- 公網 IP 不常變化

**使用方法**：
```batch
# 1. 獲取網絡配置信息
get_network_info.bat

# 2. 訪問路由器管理頁面
# 通常為：192.168.1.1 或 192.168.0.1

# 3. 配置端口轉發
# 按照提示添加以下規則：
#   外部端口 8000 → 內部端口 8000 → 本機 IP
#   外部端口 8005 → 內部端口 8005 → 本機 IP

# 4. 使用公網 IP 訪問
# 例如：http://123.45.67.89:8000
```

**訪問地址**：
- http://[您的公網IP]:8000
- http://[您的公網IP]:8005

**優點**：
- 🎯 穩定可靠
- 💰 完全免費
- 🚀 速度快

**缺點**：
- 🌐 需要路由器管理權限
- 📡 公網 IP 可能會變化
- 🔒 需要自己處理安全問題

---

### 方案 3：DDNS + 端口轉發（最佳）

**適用場景**：
- 長期使用、需要固定域名
- 家庭網絡、動態 IP
- 多人協作、商業使用

**使用方法**：
```batch
# 1. 註冊 DuckDNS
# 訪問：https://www.duckdns.org/

# 2. 配置 DDNS
# 編輯 ddns_update.bat
# 修改 DOMAIN 和 TOKEN 變量

# 3. 更新 DDNS
ddns_update.bat

# 4. 配置端口轉發（同方案2）
get_network_info.bat

# 5. 使用域名訪問
# 例如：http://myproject.duckdns.org:8000
```

**訪問地址**：
- http://myproject.duckdns.org:8000
- http://myproject.duckdns.org:8005

**優點**：
- 🏷️ 固定域名，不會變化
- 🔄 自動更新 IP
- 🆓 完全免費
- ⚡ 穩定可靠

**缺點**：
- ⚙️ 配置稍複雜
- 🔧 需要定時任務更新

---

## 📦 部署工具

| 工具 | 功能 | 使用場景 |
|------|------|----------|
| **快速部署向導.bat** | 部署方案選擇 | 首次部署 |
| **deploy_ngrok.bat** | Ngrok 內網穿透 | 快速測試 |
| **get_network_info.bat** | 網絡配置信息 | 端口轉發 |
| **ddns_update.bat** | DDNS 自動更新 | 動態域名 |

---

## 🎯 推薦流程

### 個人使用/測試

1. 運行 `快速部署向導.bat`
2. 選擇方案 1（Ngrok）
3. 等待 Ngrok 啟動完成
4. 使用 Ngrok URL 訪問服務
5. ✅ 完成！

### 家庭網絡/小團隊

1. 運行 `快速部署向導.bat`
2. 選擇方案 2（端口轉發）
3. 運行 `get_network_info.bat` 獲取配置
4. 登錄路由器配置端口轉發
5. 使用公網 IP 訪問
6. ✅ 完成！

### 長期使用/商業

1. 註冊 DuckDNS 帳號
2. 編輯 `ddns_update.bat` 配置
3. 運行 `快速部署向導.bat`
4. 選擇方案 3（DDNS）
5. 配置端口轉發
6. 使用域名訪問
7. ✅ 完成！

---

## 🔐 安全建議

### 1. 修改默認端口
```python
# 修改 website_server.py 和 remote_control_server.py
# 使用非常見端口減少被攻擊風險
```

### 2. 配置防火牆
```bash
# Windows 防火牆規則
netsh advfirewall firewall add rule name="築未科技" dir=in action=allow protocol=TCP localport=8000
```

### 3. 使用強密碼
```python
# 管理後台必須使用強密碼
# 定期更換密碼
```

### 4. 限制管理後台訪問
```python
# 只允許特定 IP 訪問 /admin
# 在 website_server.py 中添加 IP 白名單
```

### 5. 使用 HTTPS（推薦）
```bash
# 安裝 Let's Encrypt 免費 SSL 證書
# 或使用 Ngrok 自動提供的 HTTPS
```

---

## 📊 方案對比

| 方案 | 難度 | 穩定性 | 成本 | 域名 | 速度 | 推薦度 |
|------|------|--------|------|------|------|--------|
| Ngrok | ⭐ | ⭐⭐ | 免費 | 臨時 | ⭐⭐⭐ | 測試用 |
| 端口轉發 | ⭐⭐ | ⭐⭐⭐⭐ | 免費 | IP | ⭐⭐⭐⭐ | 家庭用 |
| DDNS | ⭐⭐⭐ | ⭐⭐⭐⭐ | 免費 | 固定 | ⭐⭐⭐⭐ | 長期用 |

---

## 🆘 常見問題

### Q: 無法從外網訪問？

**檢查清單**：
1. ✅ 本地服務是否運行？（運行 `test_all.py`）
2. ✅ 端口轉發是否正確配置？
3. ✅ 防火牆是否允許端口訪問？
4. ✅ 公網 IP 是否正確？

### Q: 公網 IP 經常變化？

**解決方案**：
- 使用 DDNS（方案 3）
- 設置定時任務自動更新
- 使用固定 IP 服務（需聯繫 ISP）

### Q: 路由器沒有端口轉發功能？

**替代方案**：
- 使用 Ngrok 內網穿透
- 更換支持端口轉發的路由器
- 使用 UPnP（某些路由器支持）

### Q: 端口被佔用？

**解決方案**：
- 修改服務器端口配置
- 殺死佔用端口的進程
- 使用其他端口（如 8080、8443）

---

## 📞 技術支持

### 測試系統
```bash
python test_all.py
```

### 查看日誌
- 網站服務器：查看 "築未科技 - 網站服務器" 窗口
- 遠程控制：查看 "築未科技 - 遠程控制" 窗口

### 獲取幫助
- 運行 `快速部署向導.bat`
- 查看文檔：`系統使用手冊.md`、`網絡部署指南.md`
- 查看 `快速參考.txt`

---

## 📝 部署檢查清單

部署前確認：
- [ ] 本地服務正常運行
- [ ] 網絡連接正常
- [ ] 熟悉路由器管理（如需要）
- [ ] 選擇合適的部署方案

部署後測試：
- [ ] 本機訪問正常（http://localhost:8000）
- [ ] 內網訪問正常（http://192.168.x.x:8000）
- [ ] 外網訪問正常（http://公網IP:8000）
- [ ] 所有功能正常（AI 對話、管理後台等）

安全設置：
- [ ] 配置防火牆規則
- [ ] 使用強密碼
- [ ] 限制管理後台訪問
- [ ] 考慮使用 HTTPS

---

## 🎉 開始部署

運行快速部署向導：

```batch
快速部署向導.bat
```

根據您的需求選擇合適的方案，按照提示完成部署！

---

*築未科技 © 2025 | 版本 2.0.0 | 系統狀態：✅ 正常*

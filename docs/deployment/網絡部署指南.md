# 築未科技系統 - 網絡部署指南

## 🌐 將本地服務部署到網絡

本指南將幫助您將本地運行的築未科技系統部署到網絡，讓外部用戶可以訪問。

---

## 📋 部署方案概覽

### 方案 1：內網穿透（最簡單）
適合：個人使用、測試環境、少量用戶
- **工具**: Ngrok、Cloudflare Tunnel
- **優點**: 無需配置路由器，即用即連
- **缺點**: 需要一直運行穿透工具

### 方案 2：路由器端口轉發（推薦）
適合：家庭網絡、小團隊使用
- **要求**: 需要路由器管理權限
- **優點**: 穩定、無額外依賴
- **缺點**: 需要配置路由器

### 方案 3：雲服務器部署（企業級）
適合：正式上線、多用戶、商業使用
- **平台**: 騰訊雲、阿里雲等
- **優點**: 專業、穩定、可擴展
- **缺點**: 需要購買服務器

---

## 方案 1：內網穿透（Ngrok）

### 步驟 1：安裝 Ngrok

訪問：https://ngrok.com/

1. 註冊賬號並下載 Ngrok
2. 解壓縮到任意目錄
3. 註冊賬號後獲取 authtoken

### 步驟 2：配置 Ngrok

```bash
# 配置 authtoken（替換為您的 token）
ngrok config add-authtoken YOUR_AUTH_TOKEN

# 穿透端口 8000
ngrok http 8000

# 穿透端口 8005（需要另一個終端）
ngrok http 8005
```

### 步驟 3：獲取公網地址

Ngrok 會顯示類似以下信息：
```
Forwarding    https://xxxx-xx-xx-xx-xx.ngrok-free.app -> http://localhost:8000
```

### 步驟 4：訪問服務

使用 Ngrok 提供的 URL 訪問您的服務：
- https://xxxx.ngrok-free.app （網站）
- https://yyyy.ngrok-free.app （遠程控制）

---

## 方案 2：路由器端口轉發

### 步驟 1：獲取本地 IP 地址

```bash
# Windows
ipconfig

# 查看 "IPv4 地址"，例如：192.168.1.100
```

### 步驟 2：進入路由器管理界面

1. 打開瀏覽器，訪問路由器地址（通常是 192.168.1.1 或 192.168.0.1）
2. 輸入管理員賬號和密碼

### 步驟 3：配置端口轉發

在路由器設置中找到「端口轉發」或「虛擬服務器」：

| 外部端口 | 內部端口 | 內部 IP 地址 | 協議 | 描述 |
|---------|---------|-------------|------|------|
| 8000 | 8000 | 192.168.1.100 | TCP | 網站服務器 |
| 8005 | 8005 | 192.168.1.100 | TCP | 遠程控制服務器 |

### 步驟 4：獲取公網 IP 地址

訪問：https://whatismyipaddress.com/

或使用命令：
```bash
curl ifconfig.me
```

### 步驟 5：訪問服務

使用公網 IP 地址訪問：
- http://YOUR_PUBLIC_IP:8000 （網站）
- http://YOUR_PUBLIC_IP:8005 （遠程控制）

### ⚠️ 注意事項

1. **動態 IP 問題**
   - 家庭寬帶的公網 IP 可能會變化
   - 建議使用 DDNS 服務（如 DuckDNS、No-IP）

2. **ISP 限制**
   - 某些運營商可能封鎖 80/443 以外的端口
   - 可以嘗試其他端口（如 8080、8443）

3. **安全問題**
   - 確保管理後台設置強密碼
   - 考慮使用防火牆限制訪問

---

## 方案 3：DDNS + 端口轉發（推薦）

### 使用 DuckDNS（免費）

1. **註冊 DuckDNS**
   - 訪問：https://www.duckdns.org/
   - 創建子域名（如：myproject.duckdns.org）

2. **安裝 DDNS 客戶端**

創建更新腳本 `duckdns_update.bat`：

```batch
@echo off
:: DuckDNS 更新腳本
:: 請替換以下參數

set DOMAIN=your-subdomain
set TOKEN=your-token
set IP=your-current-ip

curl "https://www.duckdns.org/update?domains=%DOMAIN%&token=%TOKEN%&ip=%IP%"

echo DDNS 更新完成
pause
```

3. **設置定時任務**
   - 打開「任務計劃程序」
   - 創建每小時運行一次的任務
   - 執行 `duckdns_update.bat`

4. **訪問服務**
   - http://myproject.duckdns.org:8000
   - http://myproject.duckdns.org:8005

---

## 🔐 安全建議

### 1. 修改默認端口
```python
# website_server.py
app = FastAPI()
# 修改為其他端口
```

### 2. 配置防火牆
```bash
# Windows 防火牆規則
netsh advfirewall firewall add rule name="築未科技網站" dir=in action=allow protocol=TCP localport=8000
```

### 3. 使用 HTTPS（推薦）
安裝 SSL 證書（Let's Encrypt 免費）

### 4. 限制管理後台訪問
```python
# 僅允許特定 IP 訪問管理後台
# 在 website_server.py 中添加 IP 過濾
```

---

## 📊 快速比較

| 方案 | 難度 | 穩定性 | 成本 | 適用場景 |
|------|------|--------|------|----------|
| Ngrok | ⭐ | ⭐⭐ | 免費 | 測試、演示 |
| 端口轉發 | ⭐⭐ | ⭐⭐⭐⭐ | 免費 | 家庭網絡 |
| DDNS + 轉發 | ⭐⭐⭐ | ⭐⭐⭐⭐ | 免費 | 小型團隊 |
| 雲服務器 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 付費 | 企業級 |

---

## 🎯 推薦流程

**個人使用/測試**：
1. 使用 Ngrok（5分鐘完成）
2. 測試所有功能

**家庭網絡/小團隊**：
1. 配置路由器端口轉發
2. 設置 DDNS
3. 配置防火牆規則

**正式上線**：
1. 購買雲服務器
2. 使用 Docker 容器化部署
3. 配置域名和 HTTPS

---

## 📞 獲取幫助

- Ngrok 文檔：https://ngrok.com/docs
- DuckDNS：https://www.duckdns.org
- 騰訊雲：https://cloud.tencent.com/

---

*更新日期：2026-02-04*

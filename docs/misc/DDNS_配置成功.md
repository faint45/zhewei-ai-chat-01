# DDNS 配置成功 - 築未科技系統部署指南

## ✅ DDNS 配置已完成

### 📋 配置信息

| 配置项 | 值 |
|--------|-----|
| **子域名** | `zhuwei-tech` |
| **完整域名** | `zhuwei-tech.duckdns.org` |
| **DuckDNS Token** | `553407dd-d7c9-40e9-be8a-bbdaa71c24b0` |
| **公网 IP** | `1.172.28.40` |
| **本机 IP** | `192.168.1.101` |
| **状态** | ✅ 已成功更新 |

---

## 🔧 路由器端口转发配置

### 配置表

| 外部端口 | 内部端口 | 内部 IP 地址 | 协议 | 服务 |
|---------|---------|-------------|------|------|
| **8000** | **8000** | **192.168.1.101** | TCP | 网站服务器 |
| **8005** | **8005** | **192.168.1.101** | TCP | 远程控制 |

### 设置步骤

1. **访问路由器管理页面**
   - 在浏览器打开：`http://192.168.1.1` 或 `http://192.168.0.1`
   - 输入管理员账号和密码登录

2. **找到端口转发设置**
   - 通常在以下位置：
     - **虚拟服务器**（Virtual Server）
     - **端口转发**（Port Forwarding）
     - **NAT 设置**（NAT Settings）
     - **高级设置** → **端口映射**

3. **添加转发规则**
   - 点击「添加」或「新增」
   - 按照上方配置表填写：
     - 外部端口：8000
     - 内部端口：8000
     - 内部 IP：192.168.1.101
     - 协议：TCP
   - 保存规则

4. **添加第二条规则**
   - 重复步骤 3，使用端口 8005
   - 外部端口：8005
   - 内部端口：8005
   - 内部 IP：192.168.1.101
   - 协议：TCP

5. **保存并应用**
   - 保存所有设置
   - 如需要，重启路由器

---

## 🌐 部署完成后的访问地址

### 使用 DDNS 域名访问（推荐）

| 服务 | 访问地址 |
|------|---------|
| 网站首页 | http://zhuwei-tech.duckdns.org:8000 |
| AI 对话 | http://zhuwei-tech.duckdns.org:8000/chat |
| 管理后台 | http://zhuwei-tech.duckdns.org:8000/admin |
| 联系我们 | http://zhuwei-tech.duckdns.org:8000/contact |
| 远程控制 | http://zhuwei-tech.duckdns.org:8005 |

### 使用公网 IP 访问

| 服务 | 访问地址 |
|------|---------|
| 网站首页 | http://1.172.28.40:8000 |
| AI 对话 | http://1.172.28.40:8000/chat |
| 管理后台 | http://1.172.28.40:8000/admin |
| 联系我们 | http://1.172.28.40:8000/contact |
| 远程控制 | http://1.172.28.40:8005 |

---

## 📊 部署状态检查清单

### ✅ 已完成

- [x] DuckDNS 帐号注册
- [x] 子域名创建（zhuwei-tech）
- [x] Token 获取
- [x] DDNS 配置文件更新
- [x] DDNS 连接测试（响应：OK）
- [x] 公网 IP 获取（1.172.28.40）
- [x] 本机 IP 获取（192.168.1.101）

### ⏳ 待完成

- [ ] **路由器端口转发配置**（重要！）
- [ ] 外网访问测试
- [ ] 防火墙规则配置（可选，但推荐）

---

## 🚀 快速开始

### 第 1 步：启动服务

```batch
start_all_services.bat
```

确认以下服务正在运行：
- 端口 8000（网站服务器）
- 端口 8005（远程控制服务器）

### 第 2 步：配置路由器端口转发

按照上方的「路由器端口转发配置」步骤操作

### 第 3 步：测试外网访问

从外网（如手机使用 4G/5G 网络）访问：

```
http://zhuwei-tech.duckdns.org:8000
```

如果可以访问，说明部署成功！🎉

---

## 🔍 故障排除

### 问题 1：无法从外网访问

**可能原因：**
- 路由器端口转发未配置或配置错误
- 防火墙阻止了外部访问
- 运营商封锁了端口

**解决方法：**
1. 检查路由器端口转发配置
2. 临时关闭防火墙测试
3. 尝试使用其他端口（如 8080、8443）

### 问题 2：DDNS 更新失败

**可能原因：**
- Token 错误
- 子域名不存在
- 网络连接问题

**解决方法：**
1. 重新检查 Token 是否正确
2. 确认子域名已在 DuckDNS 创建
3. 检查网络连接

### 问题 3：端口被占用

**可能原因：**
- 其他程序占用了端口 8000 或 8005

**解决方法：**
```batch
# 查找占用端口的进程
netstat -ano | findstr ":8000"

# 结束进程
taskkill /PID [进程ID] /F
```

---

## 💡 维护建议

### 定期更新 DDNS

- DDNS 已设置为每小时自动更新
- 您可以在「任务计划程序」中查看「築未科技DDNS更新」任务
- 如需手动更新：运行 `ddns_update.bat`

### 监控服务状态

定期运行测试脚本检查系统状态：
```batch
python test_all.py
```

### 安全建议

1. **配置防火墙规则**
   - 只允许特定 IP 访问
   - 限制管理后台的访问

2. **定期更新系统**
   - 更新 Python 依赖包
   - 更新路由器固件

3. **备份重要数据**
   - 定期备份数据库
   - 保存配置文件

---

## 📞 获取帮助

- 查看 `duckdns_setup_guide.md` 获取详细配置指南
- 查看 `網絡部署指南.md` 了解所有部署方案
- 查看 `系統使用手冊.md` 了解系统功能

---

## 🎉 部署完成

恭喜！您的築未科技系统已配置完成！

### 快速访问地址

- **网站首页**：http://zhuwei-tech.duckdns.org:8000
- **AI 对话**：http://zhuwei-tech.duckdns.org:8000/chat
- **管理后台**：http://zhuwei-tech.duckdns.org:8000/admin
- **远程控制**：http://zhuwei-tech.duckdns.org:8005

---

築未科技 © 2025
配置日期：2025-02-04

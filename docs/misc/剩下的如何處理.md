# 築未科技 — 剩下的如何處理

**用途**：三項「你要做的」的**具體操作步驟**；照著做即可完成。

---

## 一、git push

**目的**：把本地 commit 推到 GitHub，方便版控與 Railway 從 Repo 部署。

### 步驟

1. **在 GitHub 建立一個 repo**（若還沒有）：  
   https://github.com/new → 填 repo 名稱（例如 `zhe-wei-tech`）→ Create repository。
2. **複製 repo URL**：例如 `https://github.com/你的帳號/zhe-wei-tech.git`。
3. **在專案根目錄執行**（把 URL 換成你的）：
   ```powershell
   cd c:\Users\user\Desktop\zhe-wei-tech
   scripts\git_push.bat https://github.com/你的帳號/你的repo.git
   ```
4. 若出現認證視窗，依畫面登入 GitHub 或輸入 Personal Access Token。
5. 完成後可在 GitHub 網頁看到程式碼；Railway 若已連此 Repo，會自動重新部署。

**若已有 remote**：直接執行 `git push origin main`（或 `git push -u origin main`）。

**本專案已設定 remote**：`origin` = https://github.com/faint45/zhewei-ai-chat-01.git。因遠端 main 已有其他歷史，本地已推送到遠端分支 **brain**（`git push -u origin main:brain`）。若要合併到遠端 main：到 https://github.com/faint45/zhewei-ai-chat-01/pull/new/brain 建立 Pull Request。

---

## 二、完整跑八階段

**目的**：讓單次任務／八階段流程能完整跑（階段 2、3、7 用 Gemini，階段 4、5 用 Ollama）。

### 步驟

1. **在 .env 填入 GEMINI_API_KEY**
   - 用編輯器開啟專案根目錄的 `.env`。
   - 找到 `GEMINI_API_KEY=`，在等號後面貼上你的 key（從 https://aistudio.google.com/app/apikey 取得）。
   - 存檔（勿提交 .env 到 git）。

2. **本機啟動 Ollama**
   - 若已安裝 Ollama：從開始選單或桌面開啟「Ollama」，或執行 `ollama serve`。
   - 若未安裝：到 https://ollama.com 下載安裝後再啟動。
   - 確認可連：瀏覽器開 http://localhost:11434/api/tags 有 JSON 回傳。

3. **啟動完整跑**
   - 雙擊專案根目錄的 **啟動完整跑.bat**，或執行：
     ```powershell
     cd c:\Users\user\Desktop\zhe-wei-tech
     python scripts\run_full_system.py
     ```
   - 會先跑預檢、顯示完整跑條件（GEMINI/Ollama/Claude），再啟動 brain_server。
   - 開 http://localhost:8000/admin 或 /chat，輸入任務即可走八階段。

---

## 三、外網 brain.zhe-wei.net

**目的**：讓 https://brain.zhe-wei.net 可從外網連到本機 brain_server。

### 步驟

1. **取得 Cloudflare Tunnel 完整 Token**
   - 開啟 https://one.dash.cloudflare.com → **Networks** → **Tunnels**。
   - 點你的隧道（例如 ID 開頭 9d65a17a...）。
   - 點 **Reinstall connector** 或 **Install and run a connector**。
   - 複製畫面上顯示的**整段 Token**（通常為 `eyJ...` 開頭的長字串），**不是**隧道 ID（UUID）。

2. **更新 .env**
   - 用編輯器開啟專案根目錄的 `.env`。
   - 把 `CLOUDFLARE_TOKEN=` 後面改為剛複製的**完整 Token**，存檔。

3. **重啟 Docker 容器**
   ```powershell
   cd c:\Users\user\Desktop\zhe-wei-tech
   docker compose down
   docker compose up -d
   ```

4. **確認**
   - 約 30 秒後執行 `docker compose ps`，tunnel 應為 **Up**（不是 Restarting）。
   - 瀏覽器開 https://brain.zhe-wei.net/health 或 /admin，應可連線。

**若仍無法連線**：見 **brain.zhe-wei.net_無法登入排查.md**。

---

## 四、對照表

| 剩下項目       | 你要做的（一句話） |
|----------------|--------------------|
| **git push**   | 執行 `scripts\git_push.bat <你的 GitHub repo URL>`。 |
| **完整跑八階段** | 在 .env 填 `GEMINI_API_KEY`、本機啟動 Ollama，再雙擊 **啟動完整跑.bat**。 |
| **外網 brain.zhe-wei.net** | 在 .env 把 `CLOUDFLARE_TOKEN` 改為完整 Token，執行 `docker compose down` 再 `docker compose up -d`。 |

---

## 五、完成後狀態

- **git push**：GitHub 上有程式碼（版控與備份）。
- **完整跑八階段**：管理介面輸入任務可走滿八階段（Gemini + Ollama）。
- **外網**：用 **Cloudflare Tunnel**（免費）即可，https://brain.zhe-wei.net 可從外網開啟 /admin、/chat、/health。**不必用 Railway**（Railway 要錢）；詳見 **外網部屬說明_Railway與GitHub.md**。

---

*本文件為「剩下的如何處理」操作清單；依序完成三項即可。*
